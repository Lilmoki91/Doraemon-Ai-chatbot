<!doctype html>
<html lang="ms">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">



<title>Doraemon AI Chatbot simulation Quantum & Deepthink Malaysia üá≤üáæ</title>

<style>
:root {
  --bg: #0f1724;
  --card: #0b1220;
  --accent: #6ee7b7;
  --accent2: #60a5fa;
  --muted: #cdd5e0;
  --glass: rgba(255,255,255,0.06);
}

html, body {
  height: 100%;
  margin: 0;
  font-family: "Inter", system-ui, "Segoe UI", Roboto;
  background: linear-gradient(90deg,violet, #F4A261);
  color: #ffffff;
  text-shadow: 0 0 2px rgba(255,255,255,0.2);
}

.wrap {
  max-width: 820px;
  margin: 28px auto;
  padding: 18px;
  border-radius: 14px;
  background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(0,0,0,0.25));
  box-shadow: 0 6px 24px rgba(2,6,23,0.8);
  border: 1px solid rgba(255,255,255,0.1);
}

header {
  display: flex;
  gap: 12px;
  align-items: center;
  margin-bottom: 12px;
}

.logo {
  width: 56px;
  height: 36px;
  border-radius: 10px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  color: #041d23;
  box-shadow: 0 0 12px var(--accent);
}

h1 { font-size: 18px; margin:0; color:#fff; }
p.lead { margin:0; color: yellow; /*var(--muted);*/ font-size:13px; }

/* Quantum Controls */
.quantum-controls {
  margin: 20px 0;
  padding: 10px;
  background: rgba(255,255,255,0.05);
  border-radius: 20px;
  border: 4px solid rgba(255,255,255,0.1);
  display: flex;
  flex-direction: column;
  
}


.quantum-toggle {
  display: flex;
  align-items: center;
  gap: 0px; 
  position: left;
  font-size:15px;
  
}

.toggle-btn {
  position: relative;
  width: 50px;
  height: 24px;
  background: #374151;
  border-radius: 12px;
  cursor: pointer;
  transition: background 0.3s;
  margin: 5px;
  margin-left:30px; 
}

.toggle-btn.active {
  background: var(--accent);
}

.toggle-btn::after {
  content: '';
  position: absolute;
  width: 20px;
  height: 20px;
  background: white;
  border-radius: 50%;
  top: 2px;
  left: 2px;
  transition: transform 0.3s;
}

.toggle-btn.active::after {
  transform: translateX(26px);
}

.quantum-stats {
  font-size: 12px;
  color: var(--muted);
}

/* ============================================
üìå QUANTUM CONSOLE - VERTICAL SCROLL SAHAJA
   ============================================ */
.quantum-console {
  background: #111; /*rgba(0,0,0,0.6);*/
  color: #00FF00; /*var(--accent);*/
  padding: 10px;
  border-radius: 8px;
  margin: 10px 0;
  font-family: 'Fira Code', monospace;
  font-size: 11px;
  max-height: 120px;
  overflow-y: auto; /* ‚úÖ VERTICAL SAHAJA */
  overflow-x: hidden; /* ‚ùå NO HORIZONTAL */
  border: 1px solid rgba(255,255,255,0.1);
  line-height: 2.0;
  word-wrap: break-word;
  white-space: normal;
}

.quantum-console::-webkit-scrollbar {
  width: 4px;
}

.quantum-console::-webkit-scrollbar-track {
  background: transparent;
}

.quantum-console::-webkit-scrollbar-thumb {
  background: #00FF00; /*var(--accent2);*/
  border-radius: 3px;
}

.quantum-badge {
  background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);
  background-size: 400% 400%;
  animation: gradientShift 3s ease infinite;
  color: white;
  padding: 3px 8px;
  border-radius: 30px;
  font-size: 10px;
  font-weight: 600;
  display: inline-block;
  margin-top: 1px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}

@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* Deep Think Badge Styling */
.deep-think-badge {
    background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
    color: white;
    padding: 3px 10px;
    border-radius: 15px;
    font-size: 11px;
    font-weight: bold;
    display: inline-block;
    animation: deepPulse 2s infinite;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}

@keyframes deepPulse {
    0% { 
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7);
    }
    50% { 
        transform: scale(1.05);
        box-shadow: 0 0 0 5px rgba(255, 107, 107, 0);
    }
    100% { 
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(255, 107, 107, 0);
    }
}


.chat {
  min-height: 68vh;
  height: 520px;
  background: var(--card);
  margin-top: 14px;
  border-radius: 10px;
  padding: 14px;
  overflow: auto;
  scroll-behavior: smooth;
  border: 1px solid rgba(255,255,255,0.08);
}

.msg { 
   display:flex; 
   gap:10px; 
   margin-bottom:12px; 
}

.bubble {
  max-width:78%;
  padding:10px 12px;
  border-radius:12px;
  line-height:1.55;
  white-space: pre-line;
  word-wrap: break-word;
  font-size:15px;
  overflow-wrap: break-word;
}

.user .bubble {
  margin-left:auto;
  background: linear-gradient(90deg, #1c2433, #283445);
  border:1px solid rgba(255,255,255,0.05);
  color:#e2eaff;
  font-weight:400;
}

.ai .bubble {
  max-width: 95%;
  background: linear-gradient(135deg,  #2A9CAD, violet); /*var(--glass);*/
/*border:5px solid , #1e40af;*/
  color:#ffffff;
  backdrop-filter: blur(8px);
  font-weight:400;
}

/* Heading styles inside chat bubbles */
.bubble h1 { 
  font-size: 20px; 
  margin: 8px 0 6px; color: #fff; 
}

.bubble h2 {
  font-size: 15px; 
  margin: 6px 0; 
  color: #e9f9f0;
}

/* Blockquote > */
.bubble blockquote {
  margin: 8px 0;
  padding: 8px 12px;
  border-left: 6px solid gold; /*#00ff66;*/  /*rgba(110,231,183,0.6);*/
  background: #2FA48F; /*rgba(255,255,255,0.02);*/
  color: white;  /*#dff7ee;*/
  border-radius: 6px;
  font-style: italic;
}

/* Highlight neon kuning */
.hl {
  background: #ffff66;
  color: #000;
  padding: 2px 4px;
  border-radius: 4px;
  font-weight: 600;
}

/* Underline text */
.ul {
  text-decoration: underline;
  text-decoration-color: red;
  color: !important;
  font-weight: 450;
  
}

/* Lists spacing */
.bubble ul, .bubble ol { 
  margin: 8px 0 8px 18px; 
}
.bubble li { margin: 4px 0; 
}
.bubble del { 
  color: #ffb3b3;
  text-decoration: line-through; 
}

.meta { 
   font-size:12px; 
   color:var(--muted); 
   margin-bottom:6px; 
}

/* fungsi ui butang chat mesej */
.controls-wrapper {
  display: flex;
  flex-direction: column;
  gap: 5px;
  margin-top: 5px;
  align-items: flex-start;
}

.input-container {
  position: relative;
  width: 100%;
  display: flex;
  align-items: flex-end; /* Ubah ke flex-end agar butang ikut ke bawah */
}

/* CURSOR HIJAU NEON kotak CHAT-INPUT */
.chat-input {
  flex: 1; 
  padding: 10px 45px 10px 15px; 
  border-radius: 30px; 
  border: 2px solid rgba(255,255,255,0.1);
  background: rgba(255,255,255,0.05); 
  color: #fff; 
  font-size: 16px; 
  outline: none; 
  transition: all 0.3s;
  width: 100%;
  resize: none;
  min-height: 42px;
  max-height: 120px;
  overflow-y: auto;
  font-family: inherit;
  line-height: 1.6;
  box-sizing: border-box;
  
  /* CURSOR HIJAU NEON */
  caret-color: #00FF00; /* Hijau neon */
  cursor: text; /* Pastikan cursor type text */
}

/* Scrollbar styling untuk textarea - KUNING NEON */
 .chat-input {
  direction: rtl; /*Ini akan memindahkan scrollbar ke kiri*/ 
  text-align: left; /* Pastikan teks tetap rata kiri */
  unicode-bidi: plaintext; /* Pastikan teks ditampilkan dengan benar */
/*padding: 12px 16px;*/
  box-sizing: border-box;
  overflow-y: auto;
  
  /* BORDER WARNA ASAL - tidak diubah */
  border: 1px solid #ccc;
  
}


/*boder user semasa menaip*/
/* KESAN PURPLE BLUE GLOW PULSING */
.chat-input:focus {
  border: 2px solid var(--accent);
  outline: none;
  background: #162C4F;
  
/* PURPLE BLUE GLOW PULSING */
  animation: purpleBluePulse 1.5s infinite ease-in-out;
}

@keyframes purpleBluePulse {
  0% {
    box-shadow: 
      0 0 8px var(--accent),
      0 0 15px rgba(147, 51, 234, 0.5),  /* purple */
      0 0 25px rgba(59, 130, 246, 0.3);  /* blue */
  }
  50% {
    box-shadow: 
      0 0 12px var(--accent),
      0 0 22px rgba(147, 51, 234, 0.7),  /* purple kuat */
      0 0 35px rgba(59, 130, 246, 0.5),  /* blue kuat */
      0 0 45px rgba(139, 92, 246, 0.2);  /* light purple */
  }
  100% {
    box-shadow: 
      0 0 8px var(--accent),
      0 0 15px rgba(147, 51, 234, 0.5),
      0 0 25px rgba(59, 130, 246, 0.3);
  }
}

/* SCROLLBAR KUNING NEON */
 .chat-input::-webkit-scrollbar {
  width: 0.3rem;
  display: none;
}

.chat-input::-webkit-scrollbar-track {
  background: transparent;
  margin: 12px 0;
  border-radius: 3px;
}

.chat-input::-webkit-scrollbar-thumb {
  background: #FFFF00; /* Kuning neon */
  border-radius: 3px;
  box-shadow: 0 0 6px #FFFF00; /* Glow effect */
}

.chat-input::-webkit-scrollbar-thumb:hover {
  background: #FFD700; /* Kuning lebih terang saat hover */
  box-shadow: 0 0 8px #FFFF00; /* Glow lebih kuat */
}

/* Untuk Firefox - SCROLLBAR KUNING NEON */
.chat-input {
  scrollbar-width: none; /*thin;*/
  scrollbar-color:  #FFFF00 transparent;
}

/* Pastikan placeholder text tetap di kiri */
.chat-input::placeholder {
  direction: ltr;
  text-align: left;
  color: silver;
}

.send-btn {
  position: absolute;
  right: 5px;
  bottom: 5px; /* Butang ikut ke bawah */
  padding: 10px;
  border-radius: 50%;
  border: 0;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  color: gold;
  font-weight: 700;
  cursor: pointer;
  box-shadow: 0 0 6px var(--accent);
  transition: all 0.15s ease-in-out;
  width: 2rem;
  height: 2rem;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom:2px; 
  margin-right: 2px;
}

.send-btn:hover { 
  transform: scale(1.05); 
}

.send-btn[disabled] { 
  opacity: 0.5; 
  cursor: not-allowed;
  transform: none;
}

.clear-btn {
  padding: 10px 12px;
  border-radius: 20px;
  border: 0;
  background: linear-gradient(90deg, #ff6b6b, #ff8e8e);
  color: #041d23;
  font-weight: 700;
  cursor: pointer;
  box-shadow: 0 0 6px #ff6b6b;
  transition: transform 0.15s ease-in-out;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 0px;
}

.clear-btn:hover {
  transform: scale(1.05);
}

.clear-btn[disabled] {
  opacity: 0.5;
  cursor: not-alowed;
  transform: none;
}


/* efeck menaip cursor */
.typing-cursor::after {
  content:"‚úèÔ∏è"; 
  display:inline-block; 
  /*width:10px; height:16px;*/ 
  margin-left:6px;
  /*background:#6ee7b7;*/ 
  /*border-radius:2px;*/
  animation: blink 0.5s steps(2) infinite;
  margin-top: 10px;
  font-size: 24px;
}
@keyframes blink{50%{opacity:0;}}


/*teks terminal code*/
.bubble code{ 
  background: none; /*rgba(0,0,0,0.45);*/
  padding:2px 6px; 
  border-radius:6px; 
  color: #39ff14; 
  font-weight:600; 
  font-family: 'Fira Code', monospace;
}

/*backgroud terminal code*/
.bubble pre{ 
  background: #1E3A5F; /*rgba(0,0,0,0.6);*/ 
  padding:10px; 
  border-radius:6px; 
  overflow:auto; 
  color: #a7ffeb;
  font-size:13px; 
/*text-shadow: 0 0 5px rgba(57, 255, 20, 0.5);*/
}


/*teks link web*/
.bubble a { 
  color: cyan; /* Cyan terang */
  text-decoration: underline; 
  transition: color 0.3s ease, text-decoration 0.3s ease;
}

.bubble a:hover { 
  color: #39ff14; /* Hijau neon */
  text-decoration: underline;
  text-shadow: 0 0 5px rgba(57, 255, 20, 0.7); /* Efek glow untuk neon */
}

.bubble a:active { 
  color: navy; /*ketika diklik */
}

/* Thinking Animation untuk AI dengan GLOWING GOLD */
.thinking-animation {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    background: #00ff66;
    border-radius: 20px;
    margin: 5px 0;
}

/* TEKS untuk thinking */
.thinking-text {
    color: #000;
    font-size: 14px;
    font-weight: 600;
    margin-right: 10px;
    font-family: 'Fira Code', monospace;
}

/* Container untuk sparkles */
.thinking-dots {
    display: flex;
    gap: 8px; /* Tambah gap untuk sparkles */
}

/* SPARKLES dengan GLOWING GOLD ANIMATION */
.thinking-dot {
    /* Ganti dari dot ke sparkles */
    content: "‚ú®";
    font-size: 15px;
    display: inline-block;
    animation: thinkingBounce 1s infinite ease-in-out, 
               goldGlow 1s infinite alternate;
    filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.7));
    text-shadow: 0 0 5px rgba(57, 255, 20, 0.5);
}

.thinking-dot:nth-child(1) { 
    animation-delay: -0.32s, -0.6s; 
}
.thinking-dot:nth-child(2) { 
    animation-delay: -0.16s, -0.3s; 
}
.thinking-dot:nth-child(3) { 
    animation-delay: 0s, 0s; 
}

/* Animasi bounce */
@keyframes thinkingBounce {
    0%, 80%, 100% { 
        transform: scale(0.9);
        opacity: 0.6;
    }
    40% { 
        transform: scale(1.3);
        opacity: 1;
    }
}

/* GLOWING GOLD ANIMATION */
@keyframes goldGlow {
    0% {
        filter: drop-shadow(0 0 3px rgba(255, 215, 0, 0.7)) 
                brightness(1);
    }
    50% {
        filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.9))
                drop-shadow(0 0 12px rgba(255, 215, 0, 0.6))
                brightness(1.5);
        transform: scale(1.1);
    }
    100% {
        filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.8))
                brightness(1.2);
    }
}

/* Atau alternatif - Typing Indicator dengan gold glow */
.typing-indicator {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 10px 20px;
    background: navy;
    border-radius: 20px;
    border: 0px solid #00ff66;
    color: #00ff66;
    font-size: 14px;
}

/* Emoji lampu juga bisa diberi glow */
/* Cahaya glowing gold tanpa resize mentol */
/* üí° GOLD GLOWING EFFECT */
.typing-indicator::before {
    content: "üí°";
    font-size: 20px;
    animation: goldLightGlow 0.5s infinite alternate;
    display: inline-block;
    margin-right: 8px;
    filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.5));
text-shadow: 0 0 5px rgba(57, 255, 20, 0.5);
}

/* ANIMASI CAHAYA EMAS */
@keyframes goldLightGlow {
    0% {
        filter: 
            drop-shadow(0 0 5px rgba(255, 215, 0, 0.4))
            drop-shadow(0 0 10px rgba(255, 215, 0, 0.2))
            brightness(1);
    }
    50% {
        filter: 
            drop-shadow(0 0 15px rgba(255, 215, 0, 0.8))
            drop-shadow(0 0 25px rgba(255, 215, 0, 0.5))
            drop-shadow(0 0 35px rgba(255, 200, 0, 0.3))
            brightness(1.3);
    }
    100% {
        filter: 
            drop-shadow(0 0 25px rgba(255, 215, 0, 1))
            drop-shadow(0 0 40px rgba(255, 215, 0, 0.7))
            drop-shadow(0 0 50px rgba(255, 200, 0, 0.4))
            brightness(1.6);
    }
}

/* Teks thinking dengan glow subtle */
.typing-indicator .thinking-text {
    color: #00ff66;
    margin-right: 10px;
    font-weight: 600;
    text-shadow: 0 0 5px rgba(0, 255, 102, 0.3);
    animation: textPulse 1.5s infinite alternate;
}

@keyframes textPulse {
    0% {
        text-shadow: 0 0 1px rgba(0, 255, 102, 0.3);
    }
    100% {
        text-shadow: 0 0 5px rgba(0, 255, 102, 0.6),
                     0 0 15px rgba(0, 255, 102, 0.2);
    }
}

/* sistem bullet (‚Ä¢) */
ul {
  padding-left: 25px;
  list-style-type: none;
}

ul li {
  position: relative;
  margin-bottom: 8px;
  color: yellow; /*turquoise; /* Warna teks */
}

ul li::before {
  content: "‚Ä¢";
  color: red; /* Bullet warna merah */
  font-size: 24px;
  position: absolute;
  left: -20px;
  top: -7px;
  font-weight: bold;
}

/* ============================================
üìä RESET LENGKAP UNTUK TABLE & COLUMNS
   ============================================ */

/* 1. RESET TOTAL UNTUK COLUMNS */
.columns-container {
  display: flex !important;
  gap: 16px !important;
  margin: 0 !important;
  padding: 0 !important;
  width: 100% !important;
}

/* 2. TEXT-COLUMN - FIX JARAK DAN LAYOUT */
.text-column {
  display: flex !important;
  flex-direction: column !important;
  gap: 2px !important; /* MINIMAL GAP */
  margin: 0 !important;
  padding: 0 !important;
  width: 100% !important;
}

/* 3. FIX JARAK TAJUK - NO SPACING */
.text-column h3, 
.text-column h4 {
  color: gold !important;
  margin: 0 0 0px 0 !important;
  padding: 0 0 0px 0 !important;
  font-size: 1em !important;
  line-height: 1 !important;
  height: auto !important;
  min-height: unset !important;
}

/* 4. FIX ELEMEN SETELAH TAJUK - TARIK KE ATAS */
.text-column h3 + *,
.text-column h4 + * {
  margin-top: -5px !important; /* TARIK KE ATAS */
  position: relative !important;
  top: -2px !important;
}

/* 5. TABLE CONTAINER FIX */
.text-column .table-container {
  margin: 0 !important;
  padding: 0 !important;
  width: 100% !important;
  overflow-x: auto !important;
}

/* 6. TABLE STYLING - SIZE DAN SPACING */
.text-column .markdown-table {
  width: 100% !important;
  min-width: 300px !important; /* LEBIH KECIL */
  max-width: 100% !important;
  border-collapse: separate !important;
  border-spacing: 0 !important;
  background: gray !important;
  margin: 0 !important; /* NO MARGIN */
  padding: 0 !important;
  border-radius: 12px !important; /* LEBIH KECIL */
  overflow: hidden !important;
  font-size: 13px !important; /* LEBIH KECIL */
}

/* 7. TABLE HEADER - SIZE KECIL */
.text-column .markdown-table th {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
  padding: 6px 10px !important; /* LEBIH KECIL */
  text-align: left !important;
  font-weight: 600 !important;
  color: white !important;
  font-size: 13px !important;
}

/* 8. TABLE CELL - SIZE KECIL */
.text-column .markdown-table td {
  padding: 5px 10px !important; /* LEBIH KECIL */
  border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
  color: #e0e0e0 !important;
  font-size: 12px !important;
}

/* 9. LIST STYLING - SIZE KECIL */
.text-column ul,
.text-column ol {
  padding-left: 16px !important; /* LEBIH KECIL */
  margin: 1px 0 !important; /* MINIMAL */
  font-size: 13px !important;
}

.text-column li {
  margin-bottom: 1px !important; /* MINIMAL */
  font-size: 12px !important;
}

/* 10. BORDER RADIUS FIX */
.text-column .markdown-table tr:first-child th:first-child {
  border-top-left-radius: 12px !important;
}

.text-column .markdown-table tr:first-child th:last-child {
  border-top-right-radius: 12px !important;
}

.text-column .markdown-table tr:last-child td:first-child {
  border-bottom-left-radius: 12px !important;
}

.text-column .markdown-table tr:last-child td:last-child {
  border-bottom-right-radius: 12px !important;
}

/* 11. SCROLLBAR STYLING */
.text-column .table-container::-webkit-scrollbar {
  height: 3px !important;
}

.text-column .table-container::-webkit-scrollbar-thumb {
  background: #00FF00 !important;
  border-radius: 20px !important;
}

/* 12. OVERRIDE UNTUK SEMUA ELEMEN DALAM TEXT-COLUMN */
.text-column > * {
  margin-top: 0 !important;
  margin-bottom: 0 !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
}

/* 13. KHUSUS UNTUK LIST SETELAH TAJUK */
.text-column h3 + ul,
.text-column h4 + ul,
.text-column h3 + ol,
.text-column h4 + ol {
  margin-top: -8px !important;
  padding-top: 0 !important;
}

/* ============================================
üéØ SESENTUH KOTAK - HOVER EFFECT FUNGSI LENGKAP
   ============================================ */

/* 14. TRANSITION UNTUK SMOOTH HOVER */
.text-column .markdown-table tr {
  transition: all 0.3s ease !important;
}

/* 15. HOVER EFFECT UTAMA - BERUBAH WARNA */
.text-column .markdown-table tr:hover {
  background: #2FA48F !important; /* EMERALD HIGHLIGHT */
  cursor: pointer !important;
}

/* 16. HOVER EFFECT UNTUK SETIAP CELL */
.text-column .markdown-table tr:hover td {
  color: white !important;
  border-bottom-color: rgba(255, 255, 255, 0.3) !important;
}

/* 17. HOVER EFFECT UNTUK HEADER */
.text-column .markdown-table tr:hover th {
  background: linear-gradient(135deg, #5568d1 0%, #653a92 100%) !important;
}

/* 18. ACTIVE STATE KETIKA DIKLIK */
.text-column .markdown-table tr:active {
  background: #1E8C7A !important;
  transform: scale(0.995) !important;
  transition: all 0.1s ease !important;
}

/* 19. FOCUS STATE UNTUK ACCESSIBILITY */
.text-column .markdown-table tr:focus {
  outline: 2px solid #2FA48F !important;
  outline-offset: 2px !important;
}

/* 20. EFFECT PADA SCROLLBAR KETIKA HOVER */
.text-column .table-container:hover::-webkit-scrollbar-thumb {
  background: #00CC00 !important;
  box-shadow: 0 0 5px rgba(0, 255, 0, 0.5) !important;
}

/* 21. HOVER EFFECT UNTUK LIST ITEMS (JIKA PAKAI LIST) */
.text-column ul li:hover,
.text-column ol li:hover {
  background: rgba(47, 164, 143, 0.2) !important;
  border-radius: 4px !important;
  padding-left: 8px !important;
  margin-left: -8px !important;
  transition: all 0.3s ease !important;
}

/*================*/
/* web üåê button */
/*================*/
.web-btn {
  padding: 12px;
  border-radius: 50%;
  border: 0;
  background: linear-gradient(135deg, #4A90E2, #357ABD);
  color: white; /* Logo globe warna putih */
  font-size: 10px; /* Size icon globe */
  cursor: pointer;
  box-shadow: 0 0 12px rgba(74, 144, 226, 0.6);
  transition: all 0.3s ease;
  width: 4rem; /* Lebar dan tinggi sama untuk bulat */
  height: 4rem; /* Bulat sempurna */
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 0px; /* Remove margin-top */
}

.web-btn:hover {
  transform: scale(1.1);
  box-shadow: 0 0 18px rgba(74, 144, 226, 0.9);
  background: linear-gradient(135deg, #357ABD, #4A90E2);
}

.web-btn.active {
  background: linear-gradient(135deg, #00FF00, #00CC00);
  box-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
  animation: webPulse 2s infinite alternate;
}

.web-btn.active:hover {
  background: linear-gradient(135deg, #00CC00, #00FF00);
  box-shadow: 0 0 20px rgba(0, 255, 0, 0.9);
}

.web-btn[disabled] {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none !important;
  box-shadow: 0 0 8px rgba(74, 144, 226, 0.3);
}

@keyframes webPulse {
  0% { 
    box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
    transform: scale(1);
  }
  100% { 
    box-shadow: 0 0 20px rgba(0, 255, 0, 0.9);
    transform: scale(1.05);
  }
}

/* Responsive */
@media (max-width: 480px) {
  .web-btn {
    width: 2.0rem;
    height: 2.0rem;
    font-size: 18px;
    padding: 18px;
   margin-top: 0px;  
  }
  
  .web-btn:hover {
    transform: scale(1.08);
  }
}


/*======================*/
/* üåê Web Search Badge */
/*======================*/
.web-search-badge {
    display: inline-block;
    background: linear-gradient(135deg, #00FF00, #00CC00);
    color: white;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 10px;
    font-weight: bold;
    margin-left: 5px;
    vertical-align: middle;
}

/* Search Results in Chat */
.search-result-item {
    background: rgba(0, 255, 0, 0.1);
    border-left: 3px solid #00FF00;
    padding: 8px;
    margin: 5px 0;
    border-radius: 5px;
}

.search-source-icon {
    width: 16px;
    height: 16px;
    vertical-align: middle;
    margin-right: 5px;
}


@media (max-width:520px){ .wrap{ margin:12px; padding:12px;} .chat{ height:420px; } }
</style>


</head>
<body>
<main class="wrap">
  <!-- Tambah hamburger dan share button tanpa ubah layout asal -->
  <button id="hamburgerBtn" style="
    position: flex;
    left: 10px;
    top: 10px;
    background: rgba(0,0,0,0.5);
    border: 1px solid rgba(255,255,255,0.3);
    color: white;
    font-size: 18px;
    cursor: pointer;
    z-index: 1000;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 30px;
    transition: all 0.3s;
  ">
    <i class="fas fa-bars"></i>
  </button>

  <button id="shareBtn" style="
    position: absolute;
    right: 1.5rem;
    top: 1.6rem;
    background: rgba(0,122,255,0.2);
    border: 1px solid #007AFF;
    color: #007AFF;
    font-size: 16px;
    cursor: pointer;
    z-index: 1000;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.3s;
  ">
    <i class="fas fa-share-alt"></i>
  </button>

  <!-- Sidebar Menu (tersembunyi) -->
  <div id="sidebarMenu" style="
    position: fixed;
    left: -250px;
    top: 0;
    width: 250px;
    height: 100%;
    background: rgba(20, 30, 40, 0.98);
    z-index: 1001;
    transition: left 0.3s;
    padding-top: -1rem;
    box-shadow: 2px 0 10px rgba(0,0,0,0.5);
    border-right: 1px solid #007AFF;
    overflow-y: auto;
  ">
    <button id="closeMenuBtn" style="
      position: absolute;
      right: 10px;
      top: 10px;
      background: none;
      border: none;
      color: #FF3B30;
      font-size: 20px;
      cursor: pointer;
      width: 30px;
      height: 30px;
    ">
      <i class="fas fa-times"></i>
    </button>
    
    <div style="padding: 20px;">
      <h3 style="color: #007AFF; margin-top: -5px; font-size: 18px;">
        <i class="fas fa-bars"></i> Menu
      </h3>
      <div style="color: white;">
        <div style="padding: 10px 50px; border-bottom: 0px solid rgba(255,255,255,0.1); font-size: 18px; margin-bottom: 20px;">
          <i class="fas fa-home font-bold" style="margin-right: 10px; color: #FF3B30;"></i>
          <span>Home</span>
        </div>
        <div style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
          <i class="fas fa-robot" style="margin-right: 10px; color: #007AFF;"></i>
          <span>AI Settings</span>
        </div>
        <div style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
          <i class="fas fa-history" style="margin-right: 10px; color: #00ff88;"></i>
          <span>Chat History</span>
        </div>
        <div style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
          <i class="fas fa-user" style="margin-right: 10px; color: #ffcc00;"></i>
          <span>Profile</span>
        </div>
        <div style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
  <a href="mailto:khairuldinsuyitno@gmail.com" style="color: white; text-decoration: none; display: flex; align-items: center;">
    <i class="fas fa-question-circle" style="margin-right: 10px; color: #ff6600;"></i>
    <span>Help</span>
  </a>
</div>
        
        <!-- Hubungi Developer via Telegram -->
        <div style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
          <a href="https://t.me/johansetia" target="_blank" style="color: white; text-decoration: none; display: flex; align-items: center;">
            <i class="fab fa-telegram" style="margin-right: 10px; color: #0088cc;"></i>
            <span>Hubungi Developer</span>
          </a>
        </div>
      </div>
      
      <!-- Tab Icon dan Info Donasi -->
      <div style="margin-top: 30px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 5px; font-size: 12px; color: #aaa;">
        <p style="margin-bottom: 10px; line-height: 1.4;">
          <strong>Platform Doraemon AI</strong> dibangunkan secara persendirian dan kendiri, dengan sumber yang terhad.
        </p>
        <p style="margin-bottom: 10px; line-height: 1.4;">
          Bagi memastikan kelangsungan pembangunan serta kerja-kerja naik taraf sistem, sumbangan dana secara ikhlas amat dialu-alukan bagi yang berkemampuan dan merasakan platform ini memberi manfaat.
        </p>
        <p style="margin-bottom: 10px; line-height: 1.4;">
          Tiada paksaan, tiada kewajipan.<br>
          Setiap sumbangan ikhlas amat saya hargai.<br>
          Semoga hidup anda diberkahi dan dimurahkan rezeki.
        </p>
        
        <div style="margin: 15px 0; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 5px;">
          <div style="margin-bottom: 5px; color: #fff;">
            <i class="fas fa-university"></i> <strong>RHB Bank Malaysia</strong>
          </div>
          <div style="margin-bottom: 8px; font-family: monospace;">
            No Akaun: <span id="accountNumber">16207200095095</span>
          </div>
          <button id="copyAccountBtn" style="
            width: 100%;
            background: rgba(0,122,255,0.2);
            border: 1px solid #007AFF;
            color: #007AFF;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
          ">
            <i class="fas fa-copy" style="margin-right: 5px;"></i> Salin Nombor Akaun
          </button>
        </div>
        
        <div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1);">
          <div style="color: #fff; margin-bottom: 5px;">
            <i class="fas fa-user-cog"></i> <strong>Pembina platform:</strong>
          </div>
          <a href="https://t.me/johansetia" target="_blank" style="color: #0088cc; text-decoration: none; display: flex; align-items: center; font-size: 11px;">
            <i class="fab fa-telegram" style="margin-right: 5px;"></i> Telegram ‚Äî @johansetia
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Overlay untuk tutup menu -->
  <div id="menuOverlay" style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
  "></div>

  <header>
    <div class="logo">üê±</div>
    <div>
     <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

<style>
    .doraemon-text {
        font-family: 'Orbitron', monospace;
        letter-spacing: 0;
        font-weight: 700;
    }
    .red { color: #FF3B30; }
    .blue { color: #007AFF; }
    .silver { color: white; } 
</style>

<i><h1 class="doraemon-text">
    <span class="red">D</span><span class="blue">o</span><span class="silver">r</span><span class="red">a</span><span class="blue">e</span><span class="silver">m</span><span class="red">o</span><span class="blue">n</span><span class="silver"> </span>
    <span class="red">A</span><span class="blue">i</span><span class="silver"> </span>
    <span class="red">C</span><span class="blue">h</span><span class="silver">a</span><span class="red">t</span><span class="blue">B</span><span class="silver">o</span><span class="red">t</span>
</h1></i>
      <p class="lead">Ai chatbot generative simulasi Quantum & Deepthink  <b>MALAYSIA</b> üá≤üáæ</p>
    </div>
  </header>

  <!-- Quantum Controls -->
  <div class="quantum-controls">
    <div class="quantum-toggle">
      <span>‚öõÔ∏è Quantum Mode:</span>
      <div class="toggle-btn" id="quantumToggle"></div>
      <span id="quantumStatus"></span>
    </div>
    <div class="quantum-stats" id="quantumStats" style="display:none;">
      Mood: <span id="currentMood"></span> ‚Ä¢ Prob: <span id="currentProb"></span>
    </div>
  </div>

  <!-- Quantum Console -->
  <div class="quantum-console" id="quantumConsole">
 ‚öõÔ∏è Quantum deep think terminal Console Ready ‚ôæÔ∏è...
  </div>


<!--- fungsi ui chat mesej --->
<div id="chat" class="chat"></div>


<!--- fungsi footer text diakhir ui --->
<div> <div style="margin-top:11px;font-size:10px;color:var(--muted)">
<div> Ai Model: <strong>Google Gemma&trade;</strong></div>

<div>&copy; Pembina Platform: <strong>Zulkarnain Bin Suyitno</strong></div>
    
<div>&copy; pelajar sekolah menengah kebangsaan rantau panjang klang selangor <strong>MALAYSIA üá≤üáæ</strong>. Educational & experimental platform¬Æ</div>

</div>  
  
<!--- fungsi kotak menaip mesej --->
<div class="controls-wrapper">
  <div class="input-container">
    <textarea 
      id="input" 
      class="chat-input" 
      placeholder="...Taip mesej" 
      autocomplete="off"
      rows="1"
    ></textarea>
    <button id="send" class="send-btn">
      <i class="fas fa-paper-plane"></i>
    </button>
  </div>
  
  <!-- BUTANG BAWAH: Clear di kiri, üåê di kanan -->
  <div style="display: flex; gap: 10px; margin-top: 8px;">
    <button id="clear" class="clear-btn">
      <i class="fas fa-trash"></i>
    </button>
    
    <button id="webSearch" class="web-btn" title="Web Search Mode">
    <i class="fas fa-globe"></i>
</button>
  </div>
</div>

<script>
// Fungsi hamburger menu
const hamburgerBtn = document.getElementById('hamburgerBtn');
const closeMenuBtn = document.getElementById('closeMenuBtn');
const sidebarMenu = document.getElementById('sidebarMenu');
const menuOverlay = document.getElementById('menuOverlay');
const shareBtn = document.getElementById('shareBtn');
const copyAccountBtn = document.getElementById('copyAccountBtn');
const accountNumber = document.getElementById('accountNumber');

let menuOpen = false;

function openMenu() {
    sidebarMenu.style.left = '0';
    menuOverlay.style.display = 'block';
    menuOpen = true;
}

function closeMenu() {
    sidebarMenu.style.left = '-250px';
    menuOverlay.style.display = 'none';
    menuOpen = false;
}

hamburgerBtn.addEventListener('click', openMenu);
closeMenuBtn.addEventListener('click', closeMenu);
menuOverlay.addEventListener('click', closeMenu);

// Fungsi share
shareBtn.addEventListener('click', function() {
    if (navigator.share) {
        navigator.share({
            title: 'Doraemon AI ChatBot',
            text: 'Check out Doraemon AI ChatBot from Malaysia!',
            url: window.location.href
        });
    } else {
        navigator.clipboard.writeText(window.location.href)
            .then(() => alert('Link copied to clipboard!'));
    }
});

// Fungsi salin nombor akaun
copyAccountBtn.addEventListener('click', function() {
    navigator.clipboard.writeText(accountNumber.textContent)
        .then(() => {
            // Tampilkan notifikasi
            const originalText = copyAccountBtn.innerHTML;
            copyAccountBtn.innerHTML = '<i class="fas fa-check"></i> Disalin!';
            copyAccountBtn.style.background = 'rgba(0,255,136,0.2)';
            copyAccountBtn.style.borderColor = '#00ff88';
            copyAccountBtn.style.color = '#00ff88';
            
            setTimeout(() => {
                copyAccountBtn.innerHTML = originalText;
                copyAccountBtn.style.background = 'rgba(0,122,255,0.2)';
                copyAccountBtn.style.borderColor = '#007AFF';
                copyAccountBtn.style.color = '#007AFF';
            }, 2000);
        })
        .catch(err => {
            console.error('Failed to copy: ', err);
            alert('Gagal menyalin nombor akaun');
        });
});

// Close dengan ESC key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && menuOpen) {
        closeMenu();
    }
});
</script>


<script type="module">
import { GoogleGenerativeAI } from 'https://cdn.jsdelivr.net/npm/@google/generative-ai/+esm';

const API_KEY = "AIzaSyCTJ5g6TT4McfkhafdCW0qrXYOU4WZUzXI";
const MODEL = "gemma-3n-e4b-it";

const genAI = new GoogleGenerativeAI(API_KEY);
const model = genAI.getGenerativeModel({ model: MODEL });

// =====================================================
// Quantum System Configuration - DIPERBAIKI
// =====================================================
let QUANTUM_MODE = false;

// Quantum Dimensions
const QUANTUM_DIMENSIONS = [ 
    "Dimensions 1: üß† FAKTA & LOGIK",
    "Dimensions 2: üåà KREATIF & IMAGINATIF", 
    "Dimensions 3: üòé SANTAI & FRIENDLY",
    "Dimensions 4: üòÇ HUMOR & KELAKAR",
    "Dimensions 5: ü§ñ TEKNIKAL &         PROGRAMMING",
    "Dimensions 6: üí´ FALSAFAH & DEEP",
    "Dimensions 7: üìö AKADEMIK & FORMAL",
    "Dimensions 8: üé® ARTISTIK & EKSPRESIF",
    "Dimensions 9: üíÄ MISTERI & DARK",
    "Dimensions 10: üåª POSITIF & MOTIVASI",
    "Dimensions 11: üßô‚Äç‚ôÇÔ∏è MAGICAL & FANTASI",
    "Dimensions 12: üéÆ GAMING & INTERAKTIF",
    "Dimensions 13: üöÄ FUTURISTIK & SCI-FI",
    "Dimensions 14: üé≠ EMOSI & DRAMATIK",
    "Dimensions 15: üßò ZEN & SPIRITUAL",
    "Dimensions 16: üî• INTENSE & PASSIONATE"
];

// Persona asas
const persona = `üìå Zulkarnain Bin Suyitno adalah pembina sistem platform ini bersama anda - ("Ai generative quantum deepthink simulation"). Dia soarang remaja lelaki, pelajar di sekolah menengah kebangsaan rantau panjang klang selangor malaysia. Di tahun 2026 beliau berusia 16 tahun. 

üìå Objectif platform ini adalah pendidikan sekolah berasaskan teknologi it dalam sistem kecerdasana buatan Ai quantum mekanikal dan deepthink (pemikiran medalam Ai)

üìå Anda adalah AI DOREAMON! üòΩ‚ú®, Anda comel, mesra, bantu user. Fasih berbahasa Melayu dan komunikasi dengan format markdown V2: 


‚Ä¢ Header section tajuk utama (# text),
‚Ä¢ Bold (**text**),
‚Ä¢ Italic (*text*),
‚Ä¢ Highlight (==text==),
‚Ä¢ Underline (__text__),
‚Ä¢ Bullet (* text)
‚Ä¢ Lines (--- text) section pemisah tajuk utama & text,
‚Ä¢ Quotes (> text) section quotes list teks.
‚Ä¢ Table Column - contoh table colimn:

::: columns
### **Table Columns:**
| Feature | Status | Progress |
|---------|--------|----------|
| Columns | ‚úÖ Active | 100% |
| Tables | ‚úÖ Active | 100% |
| Formatting | ‚ö†Ô∏è Beta | 80% |
| Mobile | ‚ùå Planned | 0% |
:::

Berikan emoji sesuai demgan teks. JAWAB SECARA RINGKAS DAN PADAT!`;

// Message history
let messages = [
  { role: "user", parts: [{ text: persona }] },
  { role: "model", parts: [{ text: "Baik! Saya DORAEMON AI sedia membantu! üòΩ‚ú®" }] }
];

// DOM elements
const chat = document.getElementById("chat");
const input = document.getElementById("input");
const sendBtn = document.getElementById("send");
const clearBtn = document.getElementById("clear");
const quantumToggle = document.getElementById("quantumToggle");
const quantumStatus = document.getElementById("quantumStatus");
const quantumStats = document.getElementById("quantumStats");
const quantumConsole = document.getElementById("quantumConsole");
const currentMood = document.getElementById("currentMood");
const currentProb = document.getElementById("currentProb");

// =====================================================
// Quantum Toggle System
// =====================================================
quantumToggle.addEventListener('click', function() {
    QUANTUM_MODE = !QUANTUM_MODE;
    this.classList.toggle('active');
    quantumStatus.textContent = QUANTUM_MODE ? '' : '';
    
     addConsoleMessage(QUANTUM_MODE ? 
     "‚öõÔ∏è QUANTUM MODE {'ACTIVATED'} ‚úÖ: üîÆ 4 Qubit/ 16 Dimension + ‚öñÔ∏è Fibonacci Balance System Online!" :
        "‚öõÔ∏è QUANTUM MODE {'DEACTIVITED'} ‚ùé: ‚ö° CLASSIC MODE standard AI responses"
    );
});

// =====================================================
// Quantum Console System
// =====================================================
function addConsoleMessage(message) {
    const timestamp = new Date().toLocaleTimeString();
    quantumConsole.innerHTML += `<div>[${timestamp}] ${message}</div>`;
    quantumConsole.scrollTop = quantumConsole.scrollHeight;
}

function updateQuantumStats(mood, prob) {
    currentMood.textContent = mood;
    currentProb.textContent = `${(prob * 100).toFixed(1)}%`;
}

// =====================================================
// Quantum Core Functions - DIPERBAIKI SEPENUHNYA
// =====================================================
function quantum_4qubit_generator() {
    const bits = Array.from({length: 4}, () => Math.random() >= 0.5 ? 1 : 0);
    const dimension_id = parseInt(bits.join(''), 2);
    return { dimension_id, bits };
}

function fibo_balance_intensity(quantum_dimension) {
    /** 
     * FIBONACCI sebagai PENGIMBANG INTENSITI sahaja
     * Bukan pemilih dimensi - dimensi tetap dari Qubit
     */
    const fibonacci = [1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987];
    const total = fibonacci.reduce((a, b) => a + b, 0);
    const raw_intensity = fibonacci[quantum_dimension] / total;
    
    // Normalize kepada range yang lebih seimbang (10% - 70%)
    const min_intensity = 0.10;
    const max_intensity = 0.70;
    const balanced_intensity = min_intensity + (raw_intensity * (max_intensity - min_intensity));
    
    return {
        intensity: balanced_intensity,
        raw_fibo: raw_intensity
    };
}

function build_ai_prompt(user_question, quantum_dimension, balanced_intensity) {
    const dimension_prompts = {
        0:  "Jawab soalan ini dengan gaya **fakta & logik**, ringkas dan jelas. Fokus pada fakta dan data:",
        1:  "Berikan jawapan yang **ceria & imaginatif**, ramah dan penuh emoji. Gunakan kreativiti tinggi:",
        2:  "Jawab secara **santai & friendly**, mesej mesra dan menenangkan seperti kawan baik:",
        3:  "Berikan jawapan yang **lucu & ringan**, gunakan sedikit jenaka yang sopan dan kelakar:",
        4:  "Berikan solusi **teknikal & praktikal**, langkah demi langkah dengan penjelasan terperinci:",
        5:  "Jawab dengan nada **falsafah & mendalam**, penuh renungan tentang makna kehidupan:",
        6:  "Jawab secara **akademik & formal**, berikan rujukan ringkas dan struktur yang teratur:",
        7:  "Gunakan gaya **artistik & ekspresif**, guna metafora atau imejan yang indah:",
        8:  "Gunakan nada **misteri & dark**, lebih suggestive dan reflektif dengan unsur misteri:",
        9:  "Jawab dengan nada **positif & motivasi**, beri dorongan praktikal dan semangat:",
        10: "Gunakan gaya **magical & fantasi**, bermain dengan imajinasi dan wonder yang ajaib:",
        11: "Gaya **gaming & interaktif** ‚Äî pendek, bertenaga, ajak tindakan seperti dalam permainan:",
        12: "Gunakan gaya **futuristik & sci-fi** ‚Äî sebut teknologi, inovasi, masa depan yang canggih:",
        13: "Gunakan nada **emosi & dramatik**, empati mendalam dan penuh perasaan yang kuat:",
        14: "Nada **zen & spiritual** ‚Äî tenang, puitis, memberi ketenangan dan kedamaian:",
        15: "Nada **intense & passionate** ‚Äî berapi, penuh semangat, ajak bertindak dengan gigih:"
    };

    const style_instruction = dimension_prompts[quantum_dimension];

    // Modulasi intensiti berdasarkan Fibonacci balanced
    let intensity_modulator;
    if (balanced_intensity >= 0.45) {
        intensity_modulator = "üöÄ **INTENSITI TINGGI**: Berikan jawapan dengan penekanan KUAT, penuh semangat, dan ekspresif!";
    } else if (balanced_intensity >= 0.25) {
        intensity_modulator = "‚ö° **INTENSITI SEDERHANA**: Berikan jawapan yang jelas dan fokus, seimbang antara emosi dan logik.";
    } else {
        intensity_modulator = "üåø **INTENSITI RENDAH**: Berikan jawapan yang lembut dan ringkas, fokus pada penyampaian yang tenang.";
    }

    const persona_prefix = `üìå Zulkarnain Bin Suyitno adalah pembina sistem platform ini bersama anda - ("Ai generative quantum deepthink simulation"). Dia soarang remaja lelaki, pelajar di sekolah menengah kebangsaan rantau panjang klang selangor malaysia. Di tahun 2026 beliau berusia 16 tahun. 

üìå Objectif platform ini adalah pendidikan sekolah berasaskan teknologi it dalam sistem kecerdasana buatan Ai quantum mekanikal dan deepthink (pemikiran medalam Ai)

üìå Anda adalah AI DOREAMON! üòΩ‚ú®, Anda comel, mesra, bantu user. Fasih berbahasa Melayu dan komunikasi dengan format markdown V2: 

‚Ä¢ Header section tajuk utama (# text),
‚Ä¢ Bold (**text**),
‚Ä¢ Italic (*text*),
‚Ä¢ Highlight (==text==),
‚Ä¢ Underline (__text__),
‚Ä¢ Bullet (* text)
‚Ä¢ Lines (--- text) section pemisah tajuk utama & text,
‚Ä¢ Quotes (> text) section quotes list teks.
‚Ä¢ Table Column - contoh table colimn:

::: columns
### **Table Columns:**
| Feature | Status | Progress |
|---------|--------|----------|
| Columns | ‚úÖ Active | 100% |
| Tables | ‚úÖ Active | 100% |
| Formatting | ‚ö†Ô∏è Beta | 80% |
| Mobile | ‚ùå Planned | 0% |
:::

Berikan emoji sesuai demgan teks. JAWAB SECARA RINGKAS DAN PADAT!`;

    return `${persona_prefix}\n\n${style_instruction}\n\n${intensity_modulator}\n\nSoalan: "${user_question}"\n\n(Jangan sertakan arahan sistem atau metadata dalam jawapan. Jawab terus dalam gaya yang diminta.)`;
}

async function quantum_chat(user_message) {
    /** 
     * SISTEM BAHARU: 
     * 1. Qubit tentukan DIMENSI
     * 2. Fibonacci seimbangkan INTENSITI
     * 3. Gabungkan dalam prompt
     */
    const { dimension_id: quantum_dim, bits: quantum_bits } = quantum_4qubit_generator();
    const { intensity: balanced_intensity, raw_fibo: raw_intensity } = fibo_balance_intensity(quantum_dim);
    const ai_prompt = build_ai_prompt(user_message, quantum_dim, balanced_intensity);

    // Debug info yang lebih jelas
    addConsoleMessage(`üîÆ QUBIT DIMENSION: Bits=[${quantum_bits.join('')}] ‚Üí ${QUANTUM_DIMENSIONS[quantum_dim]}`);
    addConsoleMessage(`‚öñÔ∏è FIBO BALANCE: ${(balanced_intensity * 100).toFixed(1)}% intensity (Raw: ${(raw_intensity * 100).toFixed(1)}%)`);
    addConsoleMessage(`üéØ PROMPT ENGINE: ${QUANTUM_DIMENSIONS[quantum_dim]} dengan ${balanced_intensity >= 0.45 ? 'INTENSITI TINGGI' : balanced_intensity >= 0.25 ? 'INTENSITI SEDERHANA' : 'INTENSITI RENDAH'}`);

    return { 
        ai_prompt, 
        quantum_dim, 
        balanced_intensity,
        quantum_bits 
    };
}


// ==============================================
// DEEP THINK TOGGLE SYSTEM - SIMPLE & POWERFUL
// ==============================================

let deepThinkMode = false;

function createDeepThinkToggle() {
    const toggleContainer = document.createElement('div');
    toggleContainer.className = 'quantum-toggle';
    toggleContainer.style.cssText = `
        display: column;
        align-items: center;
        gap: 32px;
        margin: 5px 0px;
        
    `;

    toggleContainer.innerHTML = `
        <span>‚ôæÔ∏è DeepThink:</span>
        <div class="toggle-btn ${deepThinkMode ? 'active' : ''}" id="deepThinkToggle">
            <div class="toggle-knob"></div>
        </div>
        <span id="deepThinkStatus">${deepThinkMode ? '' : ''}</span>
    `;

    // Toggle functionality
    const toggleBtn = toggleContainer.querySelector('#deepThinkToggle');
    const statusSpan = toggleContainer.querySelector('#deepThinkStatus');

    toggleBtn.addEventListener('click', function() {
        deepThinkMode = !deepThinkMode;
        this.classList.toggle('active');
        statusSpan.textContent = deepThinkMode ? '' : '';
        
        addConsoleMessage(deepThinkMode ? 
            "‚ôæÔ∏è DEEP THINK MODE {'ACTIVATED'} ‚úÖ : üìù Detailed complex Ai responses" :
            "‚ôæÔ∏è DEEP THINK MODE {'DEACTIVATED'} ‚ùé: ‚ö° CLASSCIC MODE Standard Ai responses"
        );
    });

    // Add to quantum controls
    const quantumControls = document.querySelector('.quantum-controls');
    if (quantumControls) {
        quantumControls.appendChild(toggleContainer);
    }
}

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    createDeepThinkToggle();
});


// =====================================================
// UI Functions (MARKDOWN FORMAT)
// =====================================================
function scrollDown(){ chat.scrollTop = chat.scrollHeight; }

function escapeHtml(str) {
  if (!str) return "";
  return str
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/'/g, "&#039;");
}

function processTables(text) {
  return text.replace(/(?:\|.*\|(?:\r?\n|$))+/g, (tableMatch) => {
    const rows = tableMatch.trim().split('\n');
    
    if (rows.length < 2) return tableMatch;
    
    const headers = rows[0]
      .split('|')
      .filter(cell => cell.trim() !== '')
      .map(cell => `<th>${cell.trim()}</th>`)
      .join('');
    
    const bodyRows = rows.slice(2)
      .filter(row => row.trim() !== '')
      .map(row => {
        const cells = row
          .split('|')
          .filter(cell => cell.trim() !== '')
          .map(cell => `<td>${cell.trim()}</td>`)
          .join('');
        return `<tr>${cells}</tr>`;
      })
      .join('');
    
    return `
      <div class="table-container">
        <table class="markdown-table">
          <thead><tr>${headers}</tr></thead>
          <tbody>${bodyRows}</tbody>
        </table>
      </div>
    `;
  });
}

function renderMarkdown(inputText) {
  if (!inputText) return "";

  let text = escapeHtml(inputText);

  const codeBlocks = [];
  text = text.replace(/```([\s\S]*?)```/g, (m, p1) => {
    const idx = codeBlocks.length;
    codeBlocks.push(p1);
    return `@@CODEBLOCK_${idx}@@`;
  });

  const textColumns = [];
  text = text.replace(/:::\s*columns\s*\n([\s\S]*?)\n:::/g, (m, p1) => {
    const idx = textColumns.length;
    const columns = p1.split(/\n---\n/).map(col => col.trim());
    textColumns.push(columns);
    return `@@TEXTCOLUMNS_${idx}@@`;
  });

  text = processTables(text);

  // Heading levels
  text = text.replace(/^\s*######\s+(.*)$/gm, "<h6>$1</h6>");
  text = text.replace(/^\s*#####\s+(.*)$/gm, "<h5>$1</h5>");
  text = text.replace(/^\s*####\s+(.*)$/gm, "<h4>$1</h4>");
  text = text.replace(/^\s*###\s+(.*)$/gm, "<h3>$1</h3>");
  text = text.replace(/^\s*##\s+(.*)$/gm, "<h2>$1</h2>");
  text = text.replace(/^\s*#\s+(.*)$/gm, "<h1>$1</h1>");

  text = text.replace(/^>\s+(.+)$/gm, "<blockquote>$1</blockquote>");
  text = text.replace(/<\/blockquote>\s*<blockquote>/g, "<br>");

  text = text.replace(/~~(.*?)~~/g, "<del>$1</del>");
  text = text.replace(/==(.+?)==/g, '<span class="hl">$1</span>');
  text = text.replace(/__(.+?)__/g, '<span class="ul">$1</span>');

  text = text.replace(/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/g, 
    '<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>');

  text = text.replace(/^\s*---\s*$/gm, '<hr class="horizontal-line">');
  text = text.replace(/^\s*\*\*\*\s*$/gm, '<hr class="horizontal-line">');
  text = text.replace(/^\s*___\s*$/gm, '<hr class="horizontal-line">');

  text = text.replace(/(?:^|\n)(\s*(?:[-‚Ä¢*]\s+.+)(?:\n\s*(?:[-‚Ä¢*]\s+.+))*)/g, (m) => {
    if (/^(\n)?<(h1|h2|h3|h4|h5|h6|pre|blockquote)/.test(m)) return m;
    const items = m.trim().split(/\n/).map(l => l.replace(/^\s*[-‚Ä¢*]\s+/, ''));
    return '\n<ul>' + items.map(i => `<li>${i}</li>`).join('') + '</ul>';
  });

  text = text.replace(/(?:^|\n)(\s*(?:\d+\.\s+.+)(?:\n\s*(?:\d+\.\s+.+))*)/g, (m) => {
    if (/^(\n)?<(h1|h2|h3|h4|h5|h6|pre|blockquote)/.test(m)) return m;
    const items = m.trim().split(/\n/).map(l => l.replace(/^\s*\d+\.\s+/, ''));
    return '\n<ol>' + items.map(i => `<li>${i}</li>`).join('') + '</ol>';
  });

  text = text.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>");
  text = text.replace(/\*(.*?)\*/g, "<em>$1</em>");
  text = text.replace(/`([^`]+)`/g, "<code class=\"inline-code\">$1</code>");

  text = text.split(/\n{2,}/).map(par => par.replace(/\n/g, "<br>")).join("\n\n");

  text = text.replace(/@@CODEBLOCK_(\d+)@@/g, (m, idx) => {
    const code = escapeHtml(codeBlocks[Number(idx)]);
    return `<pre><code class="code-block">${code}</code></pre>`;
  });

  text = text.replace(/@@TEXTCOLUMNS_(\d+)@@/g, (m, idx) => {
    const columns = textColumns[Number(idx)];
    if (!columns || columns.length === 0) return '';
    
    const columnsHtml = columns.map(col => {
      let processedCol = col;
      
      processedCol = processTables(processedCol);
      
      processedCol = processedCol.replace(/^\s*######\s+(.*)$/gm, "<h6>$1</h6>");
      processedCol = processedCol.replace(/^\s*#####\s+(.*)$/gm, "<h5>$1</h5>");
      processedCol = processedCol.replace(/^\s*####\s+(.*)$/gm, "<h4>$1</h4>");
      processedCol = processedCol.replace(/^\s*###\s+(.*)$/gm, "<h3>$1</h3>");
      processedCol = processedCol.replace(/^\s*##\s+(.*)$/gm, "<h2>$1</h2>");
      processedCol = processedCol.replace(/^\s*#\s+(.*)$/gm, "<h1>$1</h1>");
      
      processedCol = processedCol.replace(/^>\s+(.+)$/gm, "<blockquote>$1</blockquote>");
      processedCol = processedCol.replace(/<\/blockquote>\s*<blockquote>/g, "<br>");
      
      processedCol = processedCol.replace(/(?:^|\n)(\s*(?:[-‚Ä¢*]\s+.+)(?:\n\s*(?:[-‚Ä¢*]\s+.+))*)/g, (listMatch) => {
        if (/^(\n)?<(h1|h2|h3|h4|h5|h6|pre|blockquote)/.test(listMatch)) return listMatch;
        const items = listMatch.trim().split(/\n/).map(l => l.replace(/^\s*[-‚Ä¢*]\s+/, ''));
        return '<ul>' + items.map(i => `<li>${i}</li>`).join('') + '</ul>';
      });
      
      processedCol = processedCol.replace(/(?:^|\n)(\s*(?:\d+\.\s+.+)(?:\n\s*(?:\d+\.\s+.+))*)/g, (listMatch) => {
        if (/^(\n)?<(h1|h2|h3|h4|h5|h6|pre|blockquote)/.test(listMatch)) return listMatch;
        const items = listMatch.trim().split(/\n/).map(l => l.replace(/^\s*\d+\.\s+/, ''));
        return '<ol>' + items.map(i => `<li>${i}</li>`).join('') + '</ol>';
      });
      
      processedCol = processedCol.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>");
      processedCol = processedCol.replace(/\*(.*?)\*/g, "<em>$1</em>");
      processedCol = processedCol.replace(/~~(.*?)~~/g, "<del>$1</del>");
      processedCol = processedCol.replace(/==(.+?)==/g, '<span class="hl">$1</span>');
      processedCol = processedCol.replace(/__(.+?)__/g, '<span class="ul">$1</span>');
      processedCol = processedCol.replace(/`([^`]+)`/g, "<code class=\"inline-code\">$1</code>");
      processedCol = processedCol.replace(/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/g, 
        '<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>');
      
      processedCol = processedCol.replace(/^\s*---\s*$/gm, '<hr class="horizontal-line">');
      
      processedCol = processedCol.split(/\n{2,}/)
        .map(par => par.replace(/\n/g, "<br>"))
        .join("\n\n");
      
      return `<div class="text-column">${processedCol}</div>`;
    }).join('');
    
    return `<div class="columns-container">${columnsHtml}</div>`;
  });

  return text;
}



function addMessage(role, text, typing = false, quantumData = null) {
  const div = document.createElement("div");
  div.className = `msg ${role}`;
  
  let badgeHtml = '';
  if (quantumData && role === 'ai' && !typing) {
      badgeHtml = `<div class="quantum-badge">${QUANTUM_DIMENSIONS[quantumData.quantum_dim]} (${(quantumData.balanced_intensity * 100).toFixed(1)}%)</div>`;
  }
  
// sistem efek typing cursor & Ai thinking
  div.innerHTML = `
  <div class="bubble">
    <div class="meta">${role==="user"?"üßë‚Äçüíª Anda":"üòΩ DOREAMON AI"}</div>
    <div class="content">${typing ? 
      '<div class="typing typing-cursor"><div class="typing-indicator"><span class="thinking-text">"Doraemon Ai sedang berfikir!"</span><div class="thinking-dots"><span class="thinking-dot">‚ú®</span><span class="thinking-dot">‚ú®</span><span class="thinking-dot">‚ú®</span></div></div></div>'  

      : renderMarkdown(text)}</div>
    ${badgeHtml}
  </div>`;
chat.appendChild(div);
scrollDown();
return { typingEl: div.querySelector(".typing"), bubbleEl: div.querySelector(".bubble") };
}

//‚úèÔ∏è‚ú® typeEffect function untuk support deep think badge
async function typeEffect(typingData, text, speed=5, quantumData = null, isDeepThink = false) {
  const { typingEl, bubbleEl } = typingData;
  
  if (!typingEl) return;
  
  typingEl.textContent = "";
  for(let i=0;i<text.length;i++){
    typingEl.textContent += text[i];
    scrollDown();
    await new Promise(r=>setTimeout(r,speed));
  }
  
  // Gantikan typing element dengan text akhir
  const contentDiv = bubbleEl.querySelector('.content');
  contentDiv.innerHTML = renderMarkdown(text);
  
  // üß† TAMBAH BADGE UNTUK DEEP THINK
  let badgeHtml = '';
  
  // Quantum badge (jika ada)
  if (quantumData && !bubbleEl.querySelector('.quantum-badge')) {
    badgeHtml += `<div class="quantum-badge">${QUANTUM_DIMENSIONS[quantumData.quantum_dim]} (${(quantumData.balanced_intensity * 100).toFixed(1)}%)</div>`;
  }
  
  // üß† Deep Think badge (jika aktif)
  if (isDeepThink && !bubbleEl.querySelector('.deep-think-badge')) {
    badgeHtml += `<div class="deep-think-badge">‚ôæÔ∏è DEEP THINK</div>`;
  }
  
  // Tambah badges ke bubble
  if (badgeHtml) {
    const badgeContainer = document.createElement('div');
    badgeContainer.style.cssText = 'display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap;';
    badgeContainer.innerHTML = badgeHtml;
    bubbleEl.appendChild(badgeContainer);
  }
}


// =====================================================
// Main Send Function
// =====================================================
async function sendMessage(){
  const userText = input.value.trim();
  if(!userText) return;

  resetInputSize();  
  
  addMessage("user", userText);
  input.value = "";
  input.disabled = true;
  sendBtn.disabled = true;
  input.focus();
  scrollDown();

  let quantumData = null;
  let finalPrompt = userText;
  
  if (deepThinkMode) {
      finalPrompt = `${userText}

üîç **MODE DEEP THINK AKTIF** - Sila berikan jawapan yang:
‚Ä¢ **MENDALAM** - Analisis komprehensif dan terperinci
‚Ä¢ **BERSTRUKTUR** - Gunakan format yang teratur 
‚Ä¢ **FAKTUAL** - Berdasarkan maklumat saintifik dan logik
‚Ä¢ **PRAKTIKAL** - Sertakan contoh aplikasi dunia sebenar
‚Ä¢ **LENGKAP** - Liputi semua aspek penting
‚Ä¢ **HiPOTESIS** - Kesimpulan semua aspek

Jawab dalam bahasa Melayu/ English dengan gaya DORAEMON yang mesra!`;
      
      addConsoleMessage("‚ôæÔ∏è DEEP THINK: üåÄ {'Asking for a deep response with historical memory'}");
  }
  
  if (QUANTUM_MODE) {
    try {
        quantumData = await quantum_chat(finalPrompt);
        finalPrompt = quantumData.ai_prompt;
        updateQuantumStats(
            QUANTUM_DIMENSIONS[quantumData.quantum_dim],
            quantumData.balanced_intensity
        );
        
        addConsoleMessage(`üéØ FINAL PROMPT: ${QUANTUM_DIMENSIONS[quantumData.quantum_dim]} dengan ${quantumData.balanced_intensity >= 0.45 ? 'INTENSITI TINGGI' : quantumData.balanced_intensity >= 0.25 ? 'INTENSITI SEDERHANA' : 'INTENSITI RENDAH'}`);
        
    } catch (error) {
        addConsoleMessage(`‚ùå Quantum Error: ${error.message}`);
    }
  }

  const { typingEl, bubbleEl } = addMessage("ai", "", true, null);

  try {
    const maxTokens = deepThinkMode ? 1500 : 800;
    
    // Prepare chat history
    const chat = model.startChat({
      history: messages,
      generationConfig: {
        maxOutputTokens: maxTokens,
        temperature: deepThinkMode ? 0.8 : 0.7,
        topP: 0.8,
        topK: 40,
      },
    });

    const result = await chat.sendMessage(finalPrompt);
    const reply = result.response.text();
    
    messages.push({ role: "user", parts: [{ text: userText }] });
    messages.push({ role: "model", parts: [{ text: reply }] });
    
    await typeEffect({ typingEl, bubbleEl }, reply, 5, quantumData, deepThinkMode);

    if (QUANTUM_MODE && quantumData) {
      addConsoleMessage(`üìù RESPONSE ANALYSIS: AI menggunakan ${QUANTUM_DIMENSIONS[quantumData.quantum_dim]} dengan ${quantumData.balanced_intensity >= 0.45 ? 'INTENSITI TINGGI' : quantumData.balanced_intensity >= 0.25 ? 'INTENSITI SEDERHANA' : 'INTENSITI RENDAH'}`);
    }

    if (deepThinkMode) {
      addConsoleMessage("‚ôæÔ∏è DEEP THINK: üìù{'Complete deep response'} ‚úÖ");
    }

  } catch (err) {
    console.error("GenAI error:", err);
    if (bubbleEl) {
      bubbleEl.querySelector('.content').innerHTML = "‚ö†Ô∏è Error: " + err.message;
    }
    if (!QUANTUM_MODE) {
      messages.pop();
    }
  } finally {
    input.disabled = false;
    sendBtn.disabled = false;    
    scrollDown();
  }
}


// =====================================================
// AUTO RESIZE & SCROLL SYSTEM
// =====================================================

// Function untuk reset input ke saiz minimum
function resetInputSize() {
    const input = document.getElementById('input');
    input.style.height = '42px'; // Kembali ke height minimum
    input.value = ''; // Kosongkan text
    handleInput(); // Update button states
}

// Function untuk auto resize textarea
function autoResize(textarea) {
    // Reset height dulu
    textarea.style.height = 'auto';
    
    // Calculate new height (max 120px)
    const newHeight = Math.min(textarea.scrollHeight, 120);
    textarea.style.height = newHeight + 'px';
}

// Function untuk handle input changes - DIPERBAIKI
function handleInput() {
    const input = document.getElementById('input');
    const sendBtn = document.getElementById('send');
    const clearBtn = document.getElementById('clear');
    
    // Auto resize
    autoResize(input);
    
    // Update button states - DIPERBAIKI
    if (input.value.trim() === '') {
        sendBtn.disabled = true;
        // CLEAR BUTTON SELALU AKTIF MESKI INPUT KOSONG!
        clearBtn.disabled = false;
    } else {
        sendBtn.disabled = false;
        clearBtn.disabled = false;
    }
    
    // PASTIKAN CLEAR BUTTON SELALU BISA DIKLIK
    if (clearBtn) {
        clearBtn.disabled = false;
        clearBtn.style.opacity = "1";
        clearBtn.style.cursor = "pointer";
    }
}

// Wire events 
sendBtn.onclick = sendMessage;

// Event listener untuk input (auto resize + button states)
input.addEventListener("input", handleInput);

// Event listener untuk keyboard
input.addEventListener("shift+keydown", e => {   
    if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
    }
});

// Clear function 
if (clearBtn) {
    clearBtn.onclick = () => { 
        // 1. Kosongkan UI chat
        chat.innerHTML = ""; 
        
        // 2. Reset messages history
        messages = [
            { role: "user", parts: [{ text: persona }] },
            { role: "model", parts: [{ text: "Baik! Saya DORAEMON AI sedia membantu! üòΩ‚ú®" }] }
        ];
        
        // 3. Clear quantum console
        if (quantumConsole) {
            quantumConsole.innerHTML = "‚öõÔ∏è Quantum Deepthink Terminal Reboot ‚ôæÔ∏è: {'Console Cleared memory & history...'} ‚ôªÔ∏è";
        }
        
        // 4. Reset input dan button states
        if (typeof resetInputSize === 'function') {
            resetInputSize();
        }
    };
}

// Initialize button states
document.addEventListener('DOMContentLoaded', function() {
    handleInput(); // Set initial button states
});


// TAMBAH INI SAHAJA:
document.addEventListener('DOMContentLoaded', function() {
        setTimeout(() => {
        initializeSecurity();
        addConsoleMessage("üîí Security: Active blocking (max 20 lines, 500 chars)");
    }, 1000);
});

// =====================================================
//üåê WEB SEARCH SEND MESSAGE FUNCTION WITH PER-CONVERSATION SOURCES üåê
// =====================================================
async function sendMessageWebSearch(){
  const userText = input.value.trim();
  if(!userText) return;

  resetInputSize();  
  addMessage("user", userText);
  input.value = "";
  input.disabled = true;
  sendBtn.disabled = true;
  input.focus();

  let finalPrompt = userText;
  let searchResults = [];
  
  // WEB SEARCH PROCESSING
  if (WEB_SEARCH_MODE) {
    try {
      addConsoleMessage("üåê {'WEB SEARCHING'}: üåÄ Search for web information...");
      
      // Show searching indicator - TEMPORARY
      const searchIndicator = document.createElement('div');
      searchIndicator.className = 'search-indicator';
      searchIndicator.innerHTML = `
        <div style="display: flex; align-items: center; gap: 8px; padding: 8px; background: #e3f2fd; border-radius: 8px; margin: 10px 0;">
          <div class="search-spinner" style="width: 1rem; height: 1rem; border: 2px solid #2196f3; border-top-color: transparent; border-radius: 90%;"></div>
          <span style="color: #1565c0; font-size: 14px;">üîç Mencari dari Web & Wikipedia...</span>
        </div>
      `;
      chat.appendChild(searchIndicator);
      scrollDown();
      
      // SEARCH ENGINES CONFIGURATION
      const SEARCH_ENGINES = [
        {
            name: "Wikipedia",
            url: (query) => `https://ms.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query.replace(/ /g, '_'))}`,
            icon: "üìö",
            type: "encyclopedia"
        },
        {
            name: "Web Search", 
            url: (query) => `https://api.duckduckgo.com/?q=${encodeURIComponent(query)}&format=json&no_html=1&t=webapp&kl=my-ms`,
            icon: "üåê",
            type: "search"
        }
      ];
      
      let sourcesFound = 0;
      
      // Search all engines
      for (const engine of SEARCH_ENGINES) {
        try {
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 8000);
          
          const response = await fetch(engine.url(userText), {
            signal: controller.signal
          });
          clearTimeout(timeoutId);
          
          if (!response.ok) continue;
          
          const data = await response.json();
          
          // Wikipedia Results
          if (engine.name === "Wikipedia" && data.extract) {
            const wikiTitle = data.title || userText;
            const wikiLink = data.content_urls?.desktop?.page || 
                            `https://ms.wikipedia.org/wiki/${encodeURIComponent(query.replace(/ /g, '_'))}`;
            
            searchResults.push({
              title: wikiTitle,
              url: wikiLink,
              content: data.extract.substring(0, 150) + (data.extract.length > 150 ? "..." : ""),
              source: 'Wikipedia',
              icon: 'üìö',
              fullContent: data.extract,
              timestamp: Date.now()
            });
            sourcesFound++;
          }
          
          // WEB SEARCH Results
          if (engine.name === "Web Search") {
            if (data.AbstractText && !data.AbstractURL?.includes('wikipedia.org')) {
              const webTitle = data.Heading || userText;
              const webLink = data.AbstractURL || 
                             `https://duckduckgo.com/?q=${encodeURIComponent(query)}&kl=my-msp`;
              
              if (!webLink.includes('wikipedia.org')) {
                searchResults.push({
                  title: webTitle,
                  url: webLink,
                  content: data.AbstractText.substring(0, 150) + (data.AbstractText.length > 150 ? "..." : ""),
                  source: 'Web Result',
                  icon: 'üåê',
                  fullContent: data.AbstractText,
                  timestamp: Date.now()
                });
                sourcesFound++;
              }
            }
            
            if (data.RelatedTopics && data.RelatedTopics.length > 0) {
              let webResultsCount = 0;
              for (const topic of data.RelatedTopics) {
                if (!topic.FirstURL || topic.FirstURL.includes('wikipedia.org')) continue;
                
                if (topic.Text && webResultsCount < 2) {
                  const topicTitle = topic.Text.split(' - ')[0] || topic.Text.substring(0, 40);
                  const topicLink = topic.FirstURL;
                  
                  searchResults.push({
                    title: topicTitle,
                    url: topicLink,
                    content: topic.Text.substring(0, 120) + (topic.Text.length > 120 ? "..." : ""),
                    source: 'Web Search',
                    icon: 'üîç',
                    fullContent: topic.Text,
                    timestamp: Date.now()
                  });
                  sourcesFound++;
                  webResultsCount++;
                }
              }
            }
          }
          
        } catch (error) {
          console.log(`${engine.name} error:`, error.message);
        }
      }
      
      // FALLBACK SYSTEM
      if (searchResults.length === 0) {
        searchResults.push({
            title: `Carian Web: ${userText}`,
            url: `https://www.google.com/search?q=${encodeURIComponent(userText)}`,
            content: `Tiada hasil carian web ditemui untuk "${userText}".`,
            source: 'Google Search',
            icon: 'üîç',
            timestamp: Date.now()
        });
      }
      
      // Remove duplicate results
      const uniqueResults = [];
      const seenUrls = new Set();
      
      for (const result of searchResults) {
        if (!seenUrls.has(result.url)) {
          seenUrls.add(result.url);
          uniqueResults.push(result);
        }
      }
      
      // Limit to 4 results maximum (lebih kecil)
      searchResults = uniqueResults.slice(0, 4);
      
      // Remove temporary indicator
      searchIndicator.remove();
      
      // CREATE COMPACT SEARCH RESULTS MESSAGE - DIKECILKAN
      const searchResultsMessage = document.createElement('div');
      searchResultsMessage.className = 'search-results-message';
      searchResultsMessage.setAttribute('data-session', Date.now());
      searchResultsMessage.style.cssText = `
        margin: 10px 0;
        animation: fadeIn 0.3s ease-in;
        background: navy;
        border-radius: 8px;
        padding: 12px;
        border: 1px solid #e0e0e0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        font-size: 13px;
        color: white;
      `;
      
      // Add compact search header
      const searchHeader = document.createElement('div');
      searchHeader.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px solid white;">
          <div style="display: flex; align-items: center; gap: 8px;">
            <span style="color: white; font-size: 16px;">üîç</span>
            <div>
              <span style="font-weight: 600; color: yellow; font-size: 13px;">Hasil Carian Web</span><br>
              <small style="color:yellow; font-size: 11px;">Untuk: "${userText.substring(0, 30)}${userText.length > 30 ? '...' : ''}"</small>
            </div>
          </div>
          <span style="background: #4caf50; color: white; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">
            ${searchResults.length} sumber
          </span>
        </div>
      `;
      searchResultsMessage.appendChild(searchHeader);
      
      // Add compact sources grid
      const sourcesGrid = document.createElement('div');
      sourcesGrid.className = 'sources-grid';
      sourcesGrid.style.cssText = `
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
        gap: 10px;
        margin-top: 8px;
      `;
      
      // Render each result - COMPACT VERSION
      searchResults.forEach((res, index) => {
        let domain = '';
        try {
          domain = new URL(res.url).hostname.replace('www.', '');
        } catch(e) { 
          domain = 'web'; 
        }

        const faviconUrl = `https://www.google.com/s2/favicons?domain=${domain}&sz=24`;

        // COMPACT CARD - PUTIH
        const card = document.createElement('a');
        card.className = 'source-card';
        card.href = res.url;
        card.target = '_blank';
        card.rel = 'noopener noreferrer';
        card.style.cssText = `
          display: block;
          padding: 10px;
          background: #ffffff;
          border-radius: 6px;
          border: 1px solid #e0e0e0;
          text-decoration: none;
          color: #333;
          transition: all 0.2s ease;
          cursor: pointer;
          font-size: 12px;
          line-height: 1.3;
        `;
        card.onmouseover = function() {
          this.style.transform = 'translateY(-2px)';
          this.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
          this.style.borderColor = '#2196f3';
        };
        card.onmouseout = function() {
          this.style.transform = 'translateY(0)';
          this.style.boxShadow = 'none';
          this.style.borderColor = '#e0e0e0';
        };
        
        card.innerHTML = `
          <div style="display: flex; align-items: flex-start; gap: 8px;">
            <div style="font-size: 18px; color: #2196f3; margin-top: 1px;">${res.icon || 'üîó'}</div>
            <div style="flex: 1; min-width: 0;">
              <div style="font-weight: 600; font-size: 12px; margin-bottom: 4px; color: #1565c0; white-space: normal; overflow: hidden; text-overflow: ellipsis;">
                ${res.title.substring(0, 40)}${res.title.length > 40 ? '...' : ''}
              </div>
              <div style="font-size: 11px; color: #555; margin-bottom: 6px; line-height: 1.3; height: 32px; overflow: hidden;">
                ${res.content}
              </div>
              <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 4px;">
                <div style="display: flex; align-items: center; gap: 5px; font-size: 10px; color: #666;">
                  <img src="${faviconUrl}" alt="" style="width: 14px; height: 14px; border-radius: 2px;" 
                       onerror="this.style.display='none'">
                  <span style="font-family: 'SF Mono', monospace;">${domain.substring(0, 15)}${domain.length > 15 ? '...' : ''}</span>
                </div>
                <span style="font-size: 10px; color: white; background: #4caf50; padding: 2px 6px; border-radius: 8px; font-weight: 500;">
                  ${res.source}
                </span>
              </div>
            </div>
          </div>
        `;
        
        sourcesGrid.appendChild(card);
      });
      
      searchResultsMessage.appendChild(sourcesGrid);
      
      // Add compact footer note
      const searchFooter = document.createElement('div');
      searchFooter.innerHTML = `
        <div style="margin-top: 10px; padding-top: 8px; border-top: 1px dashed #e0e0e0; font-size: 11px; color: silver; display: flex; align-items: center; justify-content: space-between;">
          <span style="display: flex; align-items: center; gap: 5px;">
            <span style="color: #666;">üí°</span>
            <span>Sumber rujukan Ai</span>
          </span>
          <span style="font-family: monospace; font-size: 10px; color: white;">
            ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
          </span>
        </div>
      `;
      searchResultsMessage.appendChild(searchFooter);
      
      // Insert search results message
      chat.appendChild(searchResultsMessage);
      scrollDown();
      
      // Format results untuk AI prompt
      let webInfo = "";
      searchResults.forEach((result, index) => {
        webInfo += `${result.icon} **${result.source} - ${result.title}**:\n`;
        webInfo += `${result.content}\n`;
        webInfo += `üîó **LINK**: [${result.url}](${result.url})\n\n`;
      });
      
      if (searchResults.length > 0) {
        finalPrompt = `üîç **MAKLUMAT WEB TERKINI (${searchResults.length} SUMBER)**\n\n${webInfo}**SOALAN**: "${userText}"\n\n**ARAHAN UNTUK AI**:\n` +
                     `1. Gunakan maklumat web sebagai rujukan\n` +
                     `2. Sertakan pautan jika relevan\n` +
                     `3. Jawab dalam bahasa Melayu dengan gaya DORAEMON\n` +
                     `4. Utamakan maklumat dari carian web biasa`;
        
        addConsoleMessage(`‚úÖ Web Search: ${searchResults.length} source found`);
        
      } else {
        finalPrompt = `üîç **WEB SEARCH**: Tiada maklumat web.\n\n**Soalan**: "${userText}"\n\nJawab berdasarkan pengetahuan sedia ada.`;
      }
      
    } catch (error) {
      addConsoleMessage(`‚ùå Web Search Error: ${error.message}`);
      
      const errorMsg = document.createElement('div');
      errorMsg.className = 'search-error-message';
      errorMsg.innerHTML = `
        <div style="background: #ffebee; border-left: 3px solid #f44336; padding: 10px; border-radius: 6px; margin: 10px 0; font-size: 12px;">
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
            <span style="color: #f44336;">‚ö†Ô∏è</span>
            <strong style="color: #333;">Carian Web Gagal</strong>
          </div>
          <div style="color: #666;">
            AI akan jawab dari pengetahuan sedia ada.
          </div>
        </div>
      `;
      chat.appendChild(errorMsg);
      scrollDown();
    }
  }

  const { typingEl, bubbleEl } = addMessage("ai", "", true);

  try {
    const chatHistory = model.startChat({
      history: messages,
      generationConfig: {
        maxOutputTokens: 1200,
        temperature: 0.7,
        topP: 0.8,
        topK: 40,
      },
    });

    const result = await chatHistory.sendMessage(finalPrompt);
    const reply = result.response.text();
    
    messages.push({ role: "user", parts: [{ text: userText }] });
    messages.push({ role: "model", parts: [{ text: reply }] });
    
    await typeEffect({ typingEl, bubbleEl }, reply, 5);

    if (WEB_SEARCH_MODE) {
      addConsoleMessage("üåê WEB SEARCHING: {'Responses complete'} ‚úÖ");
    }

  } catch (err) {
    console.error("GenAI error:", err);
    if (bubbleEl) {
      bubbleEl.querySelector('.content').innerHTML = "‚ö†Ô∏è Error: " + err.message;
    }
  } finally {
    input.disabled = false;
    sendBtn.disabled = false;    
    scrollDown();
  }
}

// =====================================================
// REPLACE BUTTON CLICK EVENT
// =====================================================
sendBtn.onclick = function() {
  if (WEB_SEARCH_MODE) {
    sendMessageWebSearch();
  } else {
    sendMessage();
  }
};

// =====================================================
// ADD CSS FOR ANIMATIONS & STYLES
// =====================================================
const webSearchStyle = document.createElement('style');
webSearchStyle.textContent = `
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  .search-spinner {
    animation: spin 1s linear infinite;
  }
  
  .search-indicator {
    animation: fadeIn 0.3s ease-in;
  }
  
  .search-results-message {
    animation: fadeIn 0.3s ease-in;
  }
  
  .search-error-message {
    animation: fadeIn 0.3s ease-in;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  /* Responsive grid untuk mobile */
  @media (max-width: 768px) {
    .sources-grid {
      grid-template-columns: 1fr !important;
    }
    
    .search-results-message {
      padding: 10px !important;
    }
    
    .source-card {
      padding: 8px !important;
    }
  }
  
  /* Hover effects untuk source cards */
  .source-card {
    transition: all 0.2s ease;
  }
  
  .source-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(33, 150, 243, 0.15) !important;
  }
`;
document.head.appendChild(webSearchStyle);

// =====================================================
// WEB SEARCH SYSTEM INITIALIZATION
// =====================================================
let WEB_SEARCH_MODE = false;

document.addEventListener('DOMContentLoaded', function() {
    const webSearchBtn = document.getElementById('webSearch');
    
    if (webSearchBtn) {
        webSearchBtn.addEventListener('click', function() {
            WEB_SEARCH_MODE = !WEB_SEARCH_MODE;
            
            this.classList.toggle('active');
            
            if (WEB_SEARCH_MODE) {
                this.innerHTML = '<i class="fas fa-globe"></i> <span style="font-size:12px;"></span>';
                this.style.background = 'linear-gradient(135deg, #00FF00, #00CC00)';
                this.style.color = 'white';
                addConsoleMessage("üåê WEB SEARCH: {'ACTIVATED'} ‚úÖ");
            } else {
                this.innerHTML = '<i class="fas fa-globe"></i> <span style="font-size:12px;"></span>';
                this.style.background = 'linear-gradient(135deg, #4A90E2, #357ABD)';
                this.style.color = 'white';
                addConsoleMessage("üåê WEB SEARCH: {'DEACTIVETED'} ‚ùé");
            }
        });
    }
});


// =====================================================
// SECURITY INPUT SYSTEM - ACTIVE BLOCKING
// =====================================================
const Security = {
    config: {
        MAX_INPUT_LENGTH: 500,
        MAX_LINES: 20
    },

    // REAL-TIME VALIDATION - BLOCK EXCESS INPUT
    validateInput: function(event) {
        const textarea = event.target;
        let value = textarea.value;
        
        // 1. CHECK LINE COUNT - BLOCK IF EXCEEDS
        const lines = value.split('\n').length;
        if (lines > this.config.MAX_LINES) {
            event.preventDefault();
            
            // Potong kepada MAX_LINES sahaja
            const limited = value.split('\n').slice(0, this.config.MAX_LINES).join('\n');
            textarea.value = limited;
            
            // Show warning
            this.showWarning(`‚ö†Ô∏è MAKSIMUM ${this.config.MAX_LINES} BARIS SAHAJA!`);
            return false;
        }
        
        // 2. CHECK CHARACTER COUNT
        if (value.length > this.config.MAX_INPUT_LENGTH) {
            event.preventDefault();
            textarea.value = value.substring(0, this.config.MAX_INPUT_LENGTH);
            this.showWarning(`‚ö†Ô∏è MAKSIMUM ${this.config.MAX_INPUT_LENGTH} HURUF SAHAJA!`);
            return false;
        }
        
        return true;
    },
    
    // VALIDATE ON PASTE/INPUT
    validatePaste: function(event) {
        const textarea = event.target;
        const pastedText = event.clipboardData.getData('text');
        
        // Check pasted content
        const pastedLines = pastedText.split('\n').length;
        const currentLines = textarea.value.split('\n').length;
        const totalAfterPaste = currentLines + pastedLines - 1; // -1 kerana cursor position
        
        if (totalAfterPaste > this.config.MAX_LINES) {
            event.preventDefault();
            this.showWarning(`‚ö†Ô∏è TIDAK BOLEH PASTE ${pastedLines} BARIS!`);
            return false;
        }
        
        // Check total characters
        const totalChars = textarea.value.length + pastedText.length;
        if (totalChars > this.config.MAX_INPUT_LENGTH) {
            event.preventDefault();
            this.showWarning(`‚ö†Ô∏è TIDAK BOLEH PASTE ${pastedText.length} HURUF!`);
            return false;
        }
        
        return true;
    },
    
    showWarning: function(message) {
        // Create or update warning element
        let warning = document.getElementById('security-warning');
        if (!warning) {
            warning = document.createElement('div');
            warning.id = 'security-warning';
            warning.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #f44336;
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                z-index: 9999;
                font-weight: solid;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                animation: slideIn 0.3s ease;
            `;
            document.body.appendChild(warning);
            
            // Add CSS animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100px); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100px); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }
        
        warning.textContent = message;
        warning.style.display = 'block';
        
        // Auto hide after 3 seconds
        setTimeout(() => {
            warning.style.animation = 'slideOut 0.3s ease';
            setTimeout(() => warning.style.display = 'none', 20);
        }, 500);
    }
};

// =====================================================
// REAL-TIME CHARACTER COUNTER WITH LIMIT ENFORCEMENT
// =====================================================
function createEnforcedCounter() {
    const counter = document.createElement('div');
    counter.id = 'charCount';
    counter.style.cssText = `
        position: absolute;
        bottom: -25px;
        right: 10px;
        font-size: 8px;
        font-weight: bold;
        background: #2196f3;
        color: white;
        padding: 4px 10px;
        border-radius: 12px;
        font-family: monospace;
        z-index: 10;
        pointer-events: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    `;
    
    const inputContainer = document.getElementById('input').parentElement;
    inputContainer.style.position = 'relative';
    inputContainer.appendChild(counter);
    
    return counter;
}

function updateEnforcedCounter(text) {
    const counter = document.getElementById('charCount');
    if (!counter) return;
    
    const lines = text.split('\n').length;
    const chars = text.length;
    const maxLines = 20;
    const maxChars = 500;
    
    // Calculate percentages
    const linesPercent = Math.min(100, (lines / maxLines) * 100);
    const charsPercent = Math.min(100, (chars / maxChars) * 100);
    
    // Change color based on usage
    let bgColor = '#4caf50'; // Green - safe
    let textColor = 'white';
    
    if (linesPercent > 70 || charsPercent > 70) {
        bgColor = '#ff9800'; // Orange - warning
    }
    
    if (linesPercent > 90 || charsPercent > 90) {
        bgColor = '#f44336'; // Red - danger
    }
    
    if (lines >= maxLines || chars >= maxChars) {
        bgColor = '#d32f2f'; // Dark red - limit reached
        textColor = '#ffcdd2';
    }
    
    counter.innerHTML = `
        <span style="color: ${textColor}">
            üìù ${lines}/${maxLines} baris ‚Ä¢ ${chars}/${maxChars} huruf
            ${lines >= maxLines ? ' ‚ö†Ô∏è' : ''}
        </span>
    `;
    
    counter.style.background = bgColor;
    counter.style.color = textColor;
    
    // Add title tooltip
    if (lines >= maxLines || chars >= maxChars) {
        counter.title = `‚ö†Ô∏è HAD MAKSIMUM TERCAPAI!`;
        counter.style.boxShadow = '0 0 0 2px #f44336';
    } else if (linesPercent > 80 || charsPercent > 80) {
        counter.title = `Hampir had maksimum: ${Math.round(linesPercent)}% baris, ${Math.round(charsPercent)}% huruf`;
        counter.style.boxShadow = '0 0 0 2px #ff9800';
    } else {
        counter.title = '';
        counter.style.boxShadow = '0 2px 6px rgba(0,0,0,0.2)';
    }
}

// =====================================================
// INITIALIZE ENFORCED SECURITY SYSTEM
// =====================================================
function initializeSecurity() {
    const textarea = document.getElementById('input');
    if (!textarea) return;
    
    // 1. Create counter
    createEnforcedCounter();
    updateEnforcedCounter('');
    
    // 2. Add REAL event listeners for ENFORCEMENT
    textarea.addEventListener('input', function(e) {
        // ENFORCE LINE LIMIT
        const lines = this.value.split('\n').length;
        if (lines > 20) {
            // CUT to max lines
            this.value = this.value.split('\n').slice(0, 20).join('\n');
            Security.showWarning(`‚úÇÔ∏è Dipotong ke 20 baris sahaja!`);
        }
        
        // ENFORCE CHARACTER LIMIT
        if (this.value.length > 500) {
            this.value = this.value.substring(0, 500);
            Security.showWarning(`‚úÇÔ∏è Dipotong ke 500 huruf sahaja!`);
        }
        
        // Update counter
        updateEnforcedCounter(this.value);
    });
    
    // 3. PREVENT paste that exceeds limits
    textarea.addEventListener('paste', function(e) {
        const pastedText = e.clipboardData.getData('text');
        const currentText = this.value;
        
        // Calculate what it would be after paste
        const newLines = (currentText + pastedText).split('\n').length;
        const newChars = (currentText + pastedText).length;
        
        if (newLines > 20) {
            e.preventDefault();
            Security.showWarning(`‚ö†Ô∏è Tidak boleh paste! Akan jadi ${newLines} baris (max: 20)`);
            return;
        }
        
        if (newChars > 500) {
            e.preventDefault();
            Security.showWarning(`‚ö†Ô∏è Tidak boleh paste! Akan jadi ${newChars} huruf (max: 500)`);
            return;
        }
    });
    
    // 4. Add keydown prevention for Enter key when at max lines
    textarea.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            const lines = this.value.split('\n').length;
            if (lines >= 20) {
                e.preventDefault();
                Security.showWarning(`‚èπÔ∏è Tidak boleh tambah baris! Sudah 20 baris`);
                return false;
            }
        }
    });
 }    
 
 
addConsoleMessage("==========================================");
addConsoleMessage("üöÄ DORAEMON AI SYSTEM INITIALIZED");
addConsoleMessage("‚öõÔ∏è Quantum Engine: ‚ú® Simulation Superposisi üîÆ Qubit Dimension + ‚öñÔ∏è Fibonacci Balance");
addConsoleMessage("‚ôæÔ∏è Deep Think: üìù Detailed Response Mode Available");
addConsoleMessage("üí´ Ready for Advanced AI Conversations");
addConsoleMessage("üåê Web search ready initialized");
addConsoleMessage("==========================================");

// kata pembukaan mesej
(async () => {
    const greet = `# **üîîRing-ring**
    ---
    *üëã Hai saya,* ==__Ai doraemon__,== 
     
    * **Robot kucing pintar dari masa depan abad ke22 üò∏üêæ.**`;

    const { typingEl, bubbleEl } = addMessage("ai", "", true);
    await typeEffect({ typingEl, bubbleEl }, greet, 15);
})();

</script>
</main>
</body>
</html>
